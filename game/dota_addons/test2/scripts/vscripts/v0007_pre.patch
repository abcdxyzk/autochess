commit 2883b421472c8e54ebd4a2dedf71d18307406329
Author: kk <abcdxyzk@sina.com>
Date:   Sun Jun 30 05:52:20 2019 +0800

    v0007

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index 224ace9..00e018c 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -807,7 +807,7 @@ function DAC:InitGameMode()
 	CustomGameEventManager:RegisterListener("user_settings_update", Dynamic_Wrap(DAC, "OnUpdateUserSettings") )
 
 	GameRules:GetGameModeEntity().battle_round = 1
-	GameRules:GetGameModeEntity().pilao_round = 50
+	GameRules:GetGameModeEntity().pilao_round = 5000
 	GameRules:GetGameModeEntity().difficulty = 2
 	GameRules:GetGameModeEntity().steamidlist = ''
 	GameRules:GetGameModeEntity().steamidlist_heroindex = ''
@@ -892,9 +892,13 @@ function DAC:InitGameMode()
 		},
 		[45] = {  --年兽
 			[1] = {x=4,y=7,enemy='pve_nian'},
+			[2] = {x=3,y=7,enemy='pve_nian'},
+			[3] = {x=5,y=7,enemy='pve_nian'},
 		},
 		[50] = {  --肉山大魔王
 			[1] = {x=4,y=7,enemy='pve_roshan'},
+			[2] = {x=3,y=7,enemy='pve_roshan'},
+			[3] = {x=5,y=7,enemy='pve_roshan'},
 		},
 		-- [55] = {  --for test
 		-- 	[1] = {x=4,y=5,enemy='chess_dr'},
@@ -992,7 +996,7 @@ function DAC:InitGameMode()
 	GameRules:GetGameModeEntity().is_game_ended =false
 
 	--默认卡池参数
-	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 5
+	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 10
 	GameRules:GetGameModeEntity().CHESS_INIT_COUNT = {
 		[1] = 9,
 		[2] = 9,
@@ -2180,6 +2184,7 @@ function InitHeros()
 	end
 	--从服务器获取玩家信息
 	prt('PLAYER_COUNT:'..PlayerResource:GetPlayerCount())
+	prt('v0007')
 	-- prt(GameRules:GetGameModeEntity().steamidlist_heroindex)
 	local url = "https://autochess.ppbizon.com/game/new/@"..GameRules:GetGameModeEntity().steamidlist_heroindex.."?hehe="..RandomInt(1,10000)..GetSendKey()
 	SendHTTP(url.."&from=InitHeros", function(t)
@@ -2481,14 +2486,14 @@ function InitHeros()
 			local hero_index = string.split(v,'_')[2]
 			user_info_table[steamid] = {
 				steamid = steamid,
-				candy = 0,
-				mmr = 0,
+				candy = 1000,
+				mmr = 3700,
 				match = 0,
 				zhugong = {
-					[1] = "h001_e000"
+					[1] = "h40"..RandomInt(1,9).."_e40"..RandomInt(1,9)
 				},
-				onduty_hero = "h001_e000",
-				mmr_level = 0,
+				onduty_hero = "h40"..RandomInt(1,9).."_e40"..RandomInt(1,9),
+				mmr_level = 38,
 				hero_index = tonumber(hero_index),
 			}
 		end
@@ -2524,6 +2529,8 @@ function InitHeros()
 
 
 
+			-- prt('info: sid='..steam_id..' pid='..player_id)
+
 			--装饰信使
 			SetCourier(hero, onduty_hero, onduty_hero_effect)
 
@@ -2545,7 +2552,7 @@ function InitHeros()
 				mmr_level = user_info.mmr_level,
 				queen_rank = user_info.queen_rank,
 				chess_lineup = '',
-				candy = 0,
+				candy = 1000,
 				hero_level = 0,
 				buff = '',
 				hero_damage = 0,
@@ -5207,6 +5214,9 @@ function DropItem(unit)
 			end
 		end
 	end
+	if (item_level == 0) then
+		item_level = RandomInt(1, 3)
+	end
 
 	local ITEM_LIST = {
 		[1] = {
@@ -5302,6 +5312,10 @@ function StartAPVERound()
 		})
 	end
 
+	local rrr = GameRules:GetGameModeEntity().battle_round;
+	if (rrr > 50) then
+		rrr = 50
+	end
 	for i,v in pairs (GameRules:GetGameModeEntity().counterpart) do
 		if v ~= -1 then
 			v = 0
@@ -5309,7 +5323,8 @@ function StartAPVERound()
 			CheckChess(i)
 			CancelPickChess(h)
 			StatClassCount(i)
-			LoadPVEEnemy(GameRules:GetGameModeEntity().battle_round,i)
+			-- LoadPVEEnemy(GameRules:GetGameModeEntity().battle_round,i)
+			LoadPVEEnemy(rrr, i)
 			local mana = h:GetMana()
 			if mana>5 then
 				mana = 5
@@ -5942,7 +5957,7 @@ function LoseARound(team,enemychess_new)
 			delay_time = (hero:GetAbsOrigin() - u:GetAbsOrigin()):Length2D() / 1000
 			AddStat(hero:GetPlayerID(),'deaths')
 
-			if u:FindAbilityByName('zeus_thunder') == nil then
+			if true or u:FindAbilityByName('zeus_thunder') == nil then
 				--普通敌人
 				AddAbilityAndSetLevel(u,'act_victory')
 
@@ -5964,6 +5979,9 @@ function LoseARound(team,enemychess_new)
 					iSourceAttachment = DOTA_PROJECTILE_ATTACHMENT_ATTACK_1
 				})
 				damage_all = damage_all + math.floor(GetHitDamage(u) or 1)
+				if (damage_all > GameRules:GetGameModeEntity().battle_round / 2) then
+					damage_all = GameRules:GetGameModeEntity().battle_round / 2
+				end
 			else
 				--宙斯，要雷劈的
 				AddAbilityAndSetLevel(u,'act_thunder')
@@ -6134,7 +6152,12 @@ function StartABattleRound()
 
 	
 
-	if GameRules:GetGameModeEntity().battle_boss[GameRules:GetGameModeEntity().battle_round] ~= nil then
+	local rrr = GameRules:GetGameModeEntity().battle_round;
+	if (rrr > 50) then
+		rrr = 50
+	end
+	-- if GameRules:GetGameModeEntity().battle_boss[GameRules:GetGameModeEntity().battle_round] ~= nil then
+	if GameRules:GetGameModeEntity().battle_boss[rrr] ~= nil then
 		StartAPVERound()
 	else
 		StartAPVPRound()

commit 36fd1eb02fc06be0275ef8bfb951813694ec2c25
Author: kk <abcdxyzk@sina.com>
Date:   Fri Jun 21 22:34:37 2019 +0800

    all 45 chess, init 50 god, ssr 3/100

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index 477a3ca..224ace9 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -995,10 +995,10 @@ function DAC:InitGameMode()
 	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 5
 	GameRules:GetGameModeEntity().CHESS_INIT_COUNT = {
 		[1] = 9,
-		[2] = 8,
-		[3] = 7,
-		[4] = 6,
-		[5] = 5,
+		[2] = 9,
+		[3] = 9,
+		[4] = 9,
+		[5] = 9,
 	}
 
 	GameRules:GetGameModeEntity().hero = {}
@@ -3028,9 +3028,9 @@ function StartAPrepareRound()
 
 				Timers:CreateTimer(1,function()
 					--给蓝
-					local mana = GameRules:GetGameModeEntity().battle_round + 5
-					if mana> 5 then
-						mana = 5
+					local mana = GameRules:GetGameModeEntity().battle_round + 50
+					if mana> 50 then
+						mana = 50
 					end
 
 					local lixi = math.floor(v:GetMana()/10)
@@ -3626,9 +3626,10 @@ function RandomDrawChessNew(team_id)
 	
 	local ran1 = RandomInt(1,10000)
 	local ran2 = RandomInt(1,10000)
-	if h:GetLevel() >= 7 and ran1 <= 1 and ran2 <= 1 then
+	-- if h:GetLevel() >= 7 and ran1 <= 1 and ran2 <= 1 then
+	if ran2 <= 300 then
 		this_chess = GameRules:GetGameModeEntity().chess_list_ssr[RandomInt(1,table.maxn(GameRules:GetGameModeEntity().chess_list_ssr))]
-	elseif ran1 <= 30 then
+	elseif ran1 <= GameRules:GetGameModeEntity().battle_round * 3 then
 		this_chess = 'chess_io'
 	else
 		--正常抽牌

commit 0ae555f52cb69256dffe6fed0d5a942fe6133ff0
Author: kk <abcdxyzk@sina.com>
Date:   Tue Jun 18 22:20:18 2019 +0800

    inc 2,3,4,5chess, mana=5,5,5...

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index dcdda03..477a3ca 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -995,10 +995,10 @@ function DAC:InitGameMode()
 	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 5
 	GameRules:GetGameModeEntity().CHESS_INIT_COUNT = {
 		[1] = 9,
-		[2] = 7,
-		[3] = 6,
-		[4] = 4,
-		[5] = 3,
+		[2] = 8,
+		[3] = 7,
+		[4] = 6,
+		[5] = 5,
 	}
 
 	GameRules:GetGameModeEntity().hero = {}
@@ -3028,7 +3028,7 @@ function StartAPrepareRound()
 
 				Timers:CreateTimer(1,function()
 					--给蓝
-					local mana = GameRules:GetGameModeEntity().battle_round + 1
+					local mana = GameRules:GetGameModeEntity().battle_round + 5
 					if mana> 5 then
 						mana = 5
 					end

commit 3edf6189202491688d640530c04c854f3d04ae13
Author: kk <abcdxyzk@sina.com>
Date:   Tue Jun 18 01:53:11 2019 +0800

    keep 1chess, inc 2,3,4,5chess. del 11heros

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index 20d5293..dcdda03 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -994,9 +994,9 @@ function DAC:InitGameMode()
 	--默认卡池参数
 	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 5
 	GameRules:GetGameModeEntity().CHESS_INIT_COUNT = {
-		[1] = 8,
-		[2] = 6,
-		[3] = 5,
+		[1] = 9,
+		[2] = 7,
+		[3] = 6,
 		[4] = 4,
 		[5] = 3,
 	}
@@ -1077,11 +1077,11 @@ function DAC:InitGameMode()
 
 	--能看到这行字的代码哥哥，请勿将测试服拆包内容曝光和公开讨论，谢谢
 	GameRules:GetGameModeEntity().chess_list_by_mana = {
-		[1] = {'chess_tusk','chess_axe','chess_eh','chess_clock','chess_ss','chess_bh','chess_bat','chess_dr','chess_tk','chess_am','chess_tiny','chess_mars','chess_ww','chess_om'}, --'chess_slark','chess_om'
-		[2] = {'chess_bm','chess_jugg','chess_shredder','chess_puck','chess_ck','chess_slardar','chess_luna','chess_qop','chess_wd','chess_cm','chess_fur','chess_morph','chess_pom','chess_lich'}, --'chess_riki',,'chess_rubick'
-		[3] = {'chess_ok','chess_razor','chess_wr','chess_abaddon','chess_sniper','chess_sf','chess_viper','chess_lyc','chess_pa','chess_lina','chess_tb','chess_tp','chess_dazzle','chess_veno'}, --'chess_fv','chess_sk'
+		[1] = {'chess_tusk','chess_axe','chess_eh','chess_clock','chess_ss','chess_bh','chess_bat','chess_dr','chess_tk','chess_am'}, --,'chess_tiny','chess_mars','chess_ww','chess_om'}, --'chess_slark','chess_om'
+		[2] = {'chess_bm','chess_jugg','chess_shredder','chess_puck','chess_ck','chess_slardar','chess_luna','chess_qop','chess_wd','chess_cm','chess_fur'}, --,'chess_morph','chess_pom','chess_lich'}, --'chess_riki',,'chess_rubick'
+		[3] = {'chess_ok','chess_razor','chess_wr','chess_abaddon','chess_sniper','chess_sf','chess_viper','chess_lyc','chess_pa','chess_lina','chess_tb','chess_tp'}, --,'chess_dazzle','chess_veno'}, --'chess_fv','chess_sk'
 		[4] = {'chess_kunkka','chess_doom','chess_troll','chess_nec','chess_ta','chess_medusa','chess_disruptor','chess_ga','chess_dk','chess_light','chess_ld'},--'chess_io','chess_gs'
-		[5] = {'chess_gyro','chess_th','chess_enigma','chess_tech','chess_dp','chess_zeus','chess_sven'}, --,'chess_kael',
+		[5] = {'chess_th','chess_enigma','chess_tech','chess_zeus','chess_sven'}, --'chess_gyro','chess_dp',--,'chess_kael',
 	}
 	GameRules:GetGameModeEntity().chess_list_ssr = {'chess_nec_ssr','chess_ck_ssr'} --,'chess_enigma_ssr','chess_ss_ssr'
 	GameRules:GetGameModeEntity().chess_2_mana = {

commit 82c1c021714cc39dc9f8bc49d49a032409846740
Author: kk <abcdxyzk@sina.com>
Date:   Mon Jun 17 23:43:57 2019 +0800

    4,5chess inc, item inc

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index 41f9246..20d5293 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -863,10 +863,14 @@ function DAC:InitGameMode()
 		[20] = {  --夺命双熊
 			[1] = {x=4,y=6,enemy='pve_bear_a'},
 			[2] = {x=2,y=7,enemy='pve_bear_b'},
+			[3] = {x=6,y=6,enemy='pve_melee_good_mega'},
+			[4] = {x=7,y=6,enemy='pve_melee_good_mega'},
 		},
 		[25] = {  --愤怒的枭兽
 			[1] = {x=2,y=7,enemy='pve_vulture_a'},
 			[2] = {x=7,y=7,enemy='pve_vulture_b'},
+			[3] = {x=6,y=6,enemy='pve_melee_good_mega'},
+			[4] = {x=7,y=6,enemy='pve_melee_good_mega'},
 		},
 		[30] = {  --雷隐兽
 			[1] = {x=4,y=6,enemy='pve_leishou_a'},
@@ -875,6 +879,8 @@ function DAC:InitGameMode()
 		},
 		[35] = {  --黑龙王
 			[1] = {x=4,y=5,enemy='pve_black_dragon'},
+			[2] = {x=6,y=6,enemy='pve_melee_good_mega'},
+			[3] = {x=7,y=6,enemy='pve_melee_good_mega'},
 		},
 		[40] = {  --巨魔部落
 			[1] = {x=3,y=6,enemy='pve_troll_dark_a'},
@@ -991,8 +997,8 @@ function DAC:InitGameMode()
 		[1] = 8,
 		[2] = 6,
 		[3] = 5,
-		[4] = 3,
-		[5] = 2,
+		[4] = 4,
+		[5] = 3,
 	}
 
 	GameRules:GetGameModeEntity().hero = {}
@@ -1173,14 +1179,14 @@ function DAC:InitGameMode()
 		[5] = { [40] = 2, [75] = 3, [98] = 4 },
 		[6] = { [33] = 2, [63] = 3, [94] = 4 },
 		[7] = { [30] = 2, [60] = 3, [90] = 4 },
-		[8] = { [23] = 2, [48] = 3, [78] = 4, [98] = 5 },
-		[9] = { [20] = 2, [40] = 3, [70] = 4, [95] = 5 },
-		[10] = { [15] = 2, [35] = 3, [60] = 4, [90] = 5 },
+		[8] = { [22] = 2, [47] = 3, [77] = 4, [97] = 5 },
+		[9] = { [20] = 2, [40] = 3, [70] = 4, [94] = 5 },
+		[10] = { [15] = 2, [35] = 3, [60] = 4, [88] = 5 },
 	}
 	GameRules:GetGameModeEntity().drop_item_gailv = {
 		[1] = { [50] = 1},
 		[2] = { [40] = 1},
-		[3] = { [30] = 1},
+		[3] = { [30] = 1, [80] = 2},
 		[4] = { [20] = 1, [60] = 2},
 		[5] = { [10] = 1, [40] = 2},
 		[6] = { [0] = 1, [20] = 2, [70] = 3},

commit 050b8d195298db5445f4059224c0723f7a3061b0
Author: kk <abcdxyzk@sina.com>
Date:   Mon Jun 17 21:53:03 2019 +0800

    mana+1 for round1,2,3,4

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index c57dca8..41f9246 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -3022,7 +3022,7 @@ function StartAPrepareRound()
 
 				Timers:CreateTimer(1,function()
 					--给蓝
-					local mana = GameRules:GetGameModeEntity().battle_round
+					local mana = GameRules:GetGameModeEntity().battle_round + 1
 					if mana> 5 then
 						mana = 5
 					end

commit 576b5ce992250cbeb1e1dd9c6a44f239bc304e62
Author: kk <abcdxyzk@sina.com>
Date:   Mon Jun 17 20:52:11 2019 +0800

    1. 1chess dec
    2. om come back
    3. 4,5chess gailv inc in level8,9,10
    4. del 100% item drop
    5. item drop gailv inc

diff --git a/test2/scripts/vscripts/addon_game_mode.lua b/test2/scripts/vscripts/addon_game_mode.lua
index 46b8912..c57dca8 100644
--- a/test2/scripts/vscripts/addon_game_mode.lua
+++ b/test2/scripts/vscripts/addon_game_mode.lua
@@ -988,7 +988,7 @@ function DAC:InitGameMode()
 	--默认卡池参数
 	GameRules:GetGameModeEntity().CHESS_POOL_SIZE = 5
 	GameRules:GetGameModeEntity().CHESS_INIT_COUNT = {
-		[1] = 9,
+		[1] = 8,
 		[2] = 6,
 		[3] = 5,
 		[4] = 3,
@@ -1071,7 +1071,7 @@ function DAC:InitGameMode()
 
 	--能看到这行字的代码哥哥，请勿将测试服拆包内容曝光和公开讨论，谢谢
 	GameRules:GetGameModeEntity().chess_list_by_mana = {
-		[1] = {'chess_tusk','chess_axe','chess_eh','chess_clock','chess_ss','chess_bh','chess_bat','chess_dr','chess_tk','chess_am','chess_tiny','chess_mars','chess_ww'}, --'chess_slark','chess_om'
+		[1] = {'chess_tusk','chess_axe','chess_eh','chess_clock','chess_ss','chess_bh','chess_bat','chess_dr','chess_tk','chess_am','chess_tiny','chess_mars','chess_ww','chess_om'}, --'chess_slark','chess_om'
 		[2] = {'chess_bm','chess_jugg','chess_shredder','chess_puck','chess_ck','chess_slardar','chess_luna','chess_qop','chess_wd','chess_cm','chess_fur','chess_morph','chess_pom','chess_lich'}, --'chess_riki',,'chess_rubick'
 		[3] = {'chess_ok','chess_razor','chess_wr','chess_abaddon','chess_sniper','chess_sf','chess_viper','chess_lyc','chess_pa','chess_lina','chess_tb','chess_tp','chess_dazzle','chess_veno'}, --'chess_fv','chess_sk'
 		[4] = {'chess_kunkka','chess_doom','chess_troll','chess_nec','chess_ta','chess_medusa','chess_disruptor','chess_ga','chess_dk','chess_light','chess_ld'},--'chess_io','chess_gs'
@@ -1171,22 +1171,22 @@ function DAC:InitGameMode()
 		[3] = { [60] = 2, [95] = 3 },
 		[4] = { [50] = 2, [85] = 3 },
 		[5] = { [40] = 2, [75] = 3, [98] = 4 },
-		[6] = { [33] = 2, [63] = 3, [93] = 4 },
+		[6] = { [33] = 2, [63] = 3, [94] = 4 },
 		[7] = { [30] = 2, [60] = 3, [90] = 4 },
-		[8] = { [24] = 2, [54] = 3, [84] = 4, [99] = 5 },
-		[9] = { [22] = 2, [52] = 3, [77] = 4, [97] = 5 },
-		[10] = { [19] = 2, [44] = 3, [69] = 4, [94] = 5 },
+		[8] = { [23] = 2, [48] = 3, [78] = 4, [98] = 5 },
+		[9] = { [20] = 2, [40] = 3, [70] = 4, [95] = 5 },
+		[10] = { [15] = 2, [35] = 3, [60] = 4, [90] = 5 },
 	}
 	GameRules:GetGameModeEntity().drop_item_gailv = {
-		[1] = { [80] = 1},
-		[2] = { [60] = 1},
-		[3] = { [50] = 1},
-		[4] = { [40] = 1, [80] = 2},
-		[5] = { [40] = 1, [60] = 2},
-		[6] = { [30] = 1, [60] = 2, [90] = 3},
-		[7] = { [20] = 1, [50] = 2, [80] = 3},
-		[8] = { [0] = 1, [20] = 2, [60] = 3, [90] = 4},
-		[9] = { [0] = 1, [10] = 2, [50] = 3, [80] = 4},
+		[1] = { [50] = 1},
+		[2] = { [40] = 1},
+		[3] = { [30] = 1},
+		[4] = { [20] = 1, [60] = 2},
+		[5] = { [10] = 1, [40] = 2},
+		[6] = { [0] = 1, [20] = 2, [70] = 3},
+		[7] = { [0] = 1, [10] = 2, [60] = 3},
+		[8] = { [0] = 1, [2] = 2, [50] = 3, [80] = 4},
+		[9] = { [0] = 1, [1] = 2, [40] = 3, [70] = 4},
 	}
 	GameRules:GetGameModeEntity().chess_ability_list = {
 		chess_cm = 'cm_mana_aura',
@@ -5200,7 +5200,7 @@ function DropItem(unit)
 			end
 		end
 	end
-	item_level = RandomInt(1,4)
+
 	local ITEM_LIST = {
 		[1] = {
 			[1] = 'item_suozijia',
